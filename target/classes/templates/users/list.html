<!DOCTYPE html>
<html
  lang="vi"
  xmlns:th="http://www.thymeleaf.org"
  th:replace="~{manager/layout :: layout(~{::title}, ~{::content})}"
>
  <head>
    <title>Quản lý người dùng</title>
  </head>
  <body>
    <div th:fragment="content">
      <div
        class="d-flex justify-content-between align-items-center pt-3 pb-2 mb-3 border-bottom"
      >
        <h1 class="h2"><i class="fas fa-users me-2"></i>Quản lý người dùng</h1>
        <a href="/manager/users/create" class="btn btn-primary"
          ><i class="fas fa-user-plus me-2"></i>Thêm người dùng</a
        >
      </div>
      <div class="card shadow-sm">
        <div class="card-header text-white" style="background-color: #8B7355;">
          <h6 class="mb-0">
            Danh sách người dùng (<span th:text="${#lists.size(users)}">0</span
            >)
          </h6>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-hover table-striped">
              <thead class="table-light">
                <tr>
                  <th>ID</th>
                  <th>Tên</th>
                  <th>Email</th>
                  <th>Số điện thoại</th>
                  <th>Số dư</th>
                  <th>Membership</th>
                  <th>Trạng thái</th>
                  <th class="text-center">Thao tác</th>
                </tr>
              </thead>
              <tbody>
                <tr th:each="user : ${users}">
                  <td>
                    <span
                      class="badge bg-secondary"
                      th:text="${user.id}"
                    ></span>
                  </td>
                  <td><strong th:text="${user.name}"></strong></td>
                  <td><small th:text="${user.email}"></small></td>
                  <td th:text="${user.phone}"></td>
                  <td>
                    <span
                      class="text-success"
                      th:text="${#numbers.formatDecimal(user.balance, 0, 'COMMA', 0, 'POINT')} + ' đ'"
                    ></span>
                  </td>
                  <td>
                    <span
                      th:if="${user.membership}"
                      class="badge" style="background-color: #C19A6B;"
                      th:text="${user.membership.type}"
                    ></span>
                    <span
                      th:unless="${user.membership}"
                      class="badge" style="background-color: #6F4E37;"
                      >None</span
                    >
                  </td>
                  <td>
                    <span th:if="${user.isBanned}" class="badge" style="background-color: #8B4513;"
                      >Bị khóa</span
                    >
                    <span th:unless="${user.isBanned}" class="badge" style="background-color: #A0826D;"
                      >Hoạt động</span
                    >
                  </td>
                  <td class="text-center">
                    <div class="btn-group">
                      <a
                        th:href="@{/manager/users/{id}(id=${user.id})}"
                        class="btn btn-sm btn-info"
                        title="Xem"
                        ><i class="fas fa-eye"></i
                      ></a>
                      <a
                        th:href="@{/manager/users/{id}/deposit(id=${user.id})}"
                        class="btn btn-sm btn-success"
                        title="Nạp tiền"
                        ><i class="fas fa-dollar-sign"></i
                      ></a>
                      <form
                        th:if="${!user.isBanned}"
                        th:action="@{/manager/users/{id}/ban(id=${user.id})}"
                        method="post"
                        class="d-inline"
                        onsubmit="return confirm('Bạn có chắc muốn khóa user này?')"
                      >
                        <button
                          type="submit"
                          class="btn btn-sm btn-danger"
                          title="Khóa"
                        >
                          <i class="fas fa-ban"></i>
                        </button>
                      </form>
                      <form
                        th:if="${user.isBanned}"
                        th:action="@{/manager/users/{id}/unban(id=${user.id})}"
                        method="post"
                        class="d-inline"
                        onsubmit="return confirm('Bạn có chắc muốn mở khóa user này?')"
                      >
                        <button
                          type="submit"
                          class="btn btn-sm btn-success"
                          title="Mở khóa"
                        >
                          <i class="fas fa-unlock"></i>
                        </button>
                      </form>
                    </div>
                  </td>
                </tr>
                <tr th:if="${#lists.isEmpty(users)}">
                  <td colspan="8" class="text-center text-muted py-4">
                    <i class="fas fa-inbox fa-3x mb-3 d-block"></i>Chưa có người
                    dùng nào
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
